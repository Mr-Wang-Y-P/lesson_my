<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<div class="box">
    <div>
        <label for="unDebounce">没有防抖的input</label>
        <input type="text" id="unDebounce" placeholder="请输入关键字">
    </div>
</div>
<script>
// html  css js 
// js 语言？ 浆糊， html css
// 百度搜索  search suggest 
// 全局作用域  js 当前单线程的global window 
let inputa = document.getElementById('unDebounce'); // 类型
// js 一切复杂类型都是对象， 具体是Object 那个子类型  面向对象编程？ 
// HTMLInputElement  CSSStyleDeclaration Array  push pop 
// inputa.value = '世龙'
// console.log(Object.prototype.toString.call(inputa.style));
inputa.addEventListener('keyup', function(e) {
    // console.log(Object.prototype.toString.call(e));
    // console.log(e.key, e.keyCode);
    // JS 主动拉去数据 fetch ajax(XMLHttpRequest)
    // 模块化，用户输入 
    // 频繁的事件
    // ajax 函数是高阶函数 相对于普通函数
    // 回调函数解决一个  
    let res = ajax(e.target.value, (res) => {
        console.log(res, '???????.,,,')
    }); // 异步思想   js 单线程语言
    
})
function ajax(keyword, cb) {
    // 耗时的异步 xhr  fetch setTimeout ... 
    // 去请求 通过http 协议再去后端拉去  eventloop
    // 数据格式json, 最早是 XML
    const xhr = new XMLHttpRequest(); // jser 前后端分离， 前端拉取数据的核心对象 
    // GET  HTTP Method 
    // URL 
    // JSON
    // 打开请求通道
    console.log(Object.prototype.toString.call(xhr), xhr.readyState); // 0
    xhr.open("GET", "https://www.fastmock.site/mock/995214af813bc47208cf2fcb558907e6/mall/home/multidata") // 
    console.log(xhr.readyState, '????'); 
    xhr.send() // 请求才真正的发送出去了
    // DOM 0 
    console.log(xhr.readyState, '/////'); // 1
    xhr.onreadystatechange = function() {
        // 2 HEADERS_RECEIVED 且头部和状态已经可获得   发送响应头 500   200  可以成功响应你
        // 3   属性已经包含部分数据  HTTP 分块传输 
        // 4  数据完全到达
        console.log(xhr.readyState, '---------');
        if (xhr.readyState == 4) { // 
                // cb 是一个回调函数 callback 简写 
               cb(JSON.parse(xhr.responseText));
            // return =====JSON.parse(xhr.responseText)
        }
    }
}
</script>
</body>
</html>